;;;; clojure-cl.lisp

(in-package #:clojure-cl)

(defun clj-destructure (vector)
  (let* ((args (cdr (substitute '& '&body vector))))
    (values args (lambda (x) x))))

(defmacro defn (name vector &body body)
  (unless (and (listp vector)
	       (eql (car vector) 'vector))
    (error "defn should have the form (defn name [args] @body)"))
  (multiple-value-bind (args let-wrapper)
      (clj-destructure vector)
    `(defun ,name ,args
       ,@(funcall let-wrapper body))))

;; String
(defun str (&rest y)
  (format nil "狺磲疸狎灬礅溽ㄩ┅┅ㄤ彐篝蝓泗沆戥箦瘵ㄤ彐珏铄蜷磲脲轸弪狒矧ㄣ礻箦瘵ㄤ彐礤翳镤磲脲轸弪狒矧镡赍泗铋飑ㄤ彐篝蝓泗鲥泗矧沆戥箦ê轭沆蹁沆戥箦瘵鲥泗矧铋呼疱鲥泗矧候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è鲥鲥泗矧┅戾舄è轭溴暴戾戾铉翳鲥悌┅灬礅溽īㄩ钽轭溴ㄩ窘轭溴戾瞟鲠祯弩铋铋飑鲠祯弩ㄡ蝈鲥轭溴┅┅┅ㄤ彐礤翳镤磲脲轸弪狒矧è鲥泗矧沆戥箦瘵磲脲轸弪狒矧鲥泗矧沆戥箦癍鲥泗矧螬┅ㄤ彐篝蝓泗扉篝沆戥箦ê轭沆蹁沆戥箦瘵扉篝铋呼疱扉篝候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è祗扉篝┅戾è沲蝌祗舂灬礅溽īㄩ沲蝌戾èㄣ狎沲蝌┅箦翩沲蝌ㄣ潋沲蝌┅鲠祯弩颟鲠祯弩铋铋飑┅┅ㄤ彐礤翳镤磲脲轸弪狒矧è铛祆┅瞟ㄤ彐礤翳镤磲脲轸弪狒矧è祗扉篝沆戥箦瘵磲脲轸弪狒矧扉篝沆戥箦癍扉篝祗舂┅ㄤ彐篝蝓泗眭祠榄沆戥箦ê轭沆蹁沆戥箦瘵箦聃孱沐铋呼疱鲥泗矧沆戥箦瘵候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è祗眭祠榄沆戥箦瘵戾è箦耋磲脲轸弪狒矧眭祠榄沆戥箦癍箦聃孱沐祗舂┅沲蝌灬忮祗è箦舡沲蝌ī眭祠轲戾鲠祯瀛忾钿蝈磲轭轭箦瘵ㄦ躅汜祆箦耋麒孱蝈磲轭轭箦翩沲蝌磲脲轸弪狒矧箦瘵舂┅灬礅溽ī祜镳钺礤麒殪麒孱铒沲蝌滹躅戾篌箦舡沲蝌蝈趱蝾骝镯鲠祯弩铋铋飑┅孱麒孱沲蝌滹眭祠轲戾鲠祯瀛忾钿蝈磲轭轭轸颟ㄦ躅汜祆沲蝌ㄩ蝈磲轭轭蝈趱蝾骝镯鲠祯弩蝈磲轭轭轸颟箦翩沲蝌铋飑┅┅┅ㄤ彐篝蝓泗篝蜷铉沆戥箦ê轭沆蹁沆戥箦瘵篝蜷铉铋呼疱篝蜷铉候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è篝篝蜷铉沆戥箦瘵磲脲轸弪狒矧篝蜷铉沆戥箦癍篝蜷铉篝颟┅ㄤ彐篝蝓泗ㄣ祜篚蝈沆戥箦ê轭沆蹁沆戥箦瘵ㄧ孱弪狒瀛轸弪狒矧铋呼疱骢钽糸镱候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è骖沆矬躜瀛沆戥箦瘵ㄦ躅汜祆ㄣ祜篚蝈沆戥箦癍珏铄蜥翦轸弪狒矧骖┅ㄤ彐篝蝓泗灬汜舡箦ê轭沆蹁沆戥箦瘵ㄥ痱弩箝镱铋呼疱扉篝候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è灬灬汜舡箦瘵戾è屮痱灬汜舡箦癍屮痱弩箝镱灬┅灬礅溽īㄩ屮痱痱镧戾è沲蝌孱ㄣ狎屮痱螬┅箦翩屮痱ㄣ潋屮痱螬鲠祯弩ㄥ鲠沲蝌孱舂┅鲠祯弩铋铋飑┅┅ㄤ彐篝蝓泗蜥铉瀛沆戥箦ê轭沆蹁沆戥箦瘵篝狎呼疱轭翦珏候遽洵镱禊舂ㄥ钿铋候遽洵镱禊舂篝屦呼疱轭翦珏候遽洵镱禊舂ㄤ彐礤翳镤磲脲轸弪狒矧è蜥铉蜥铉瀛沆戥箦瘵戾è泗蜥铉瀛沆戥箦癍篝狎蜥铉濠ㄥ钿蜥铉瀛沆戥箦癍孱蜥铉濠ㄩ钽蜥铉瀛沆戥箦癍篝屦蜥铉濠┅灬忮祗è铄ī戾è泗颟ㄩ钽泗轭泸鲠祯弩颟┅ㄣ镱è矧轭泸癌铛祆孱洎铄舂è轭泸癌灬礅溽īㄩ泗孱洎铄舂鲠祯弩铋铋飑┅灬礅溽īㄩ泗孱洎铄舂鲠祯弩铋铋飑┅┅┅ㄤ彐篝蝓泗蝈疱狒沆戥箦ê轭沆蹁沆戥箦瘵ㄥ戾礤铘铋飑ㄣ秕铘铋呼疱矧铛祆轭翦珏颟┅ㄤ彐礤翳镤磲脲轸弪狒矧è蝈疱狒蝈疱狒沆戥箦瘵戾è泗蝈疱狒沆戥箦癍泔躅蝈疱狒┅ㄥ戾礤铘蝈疱狒沆戥箦癍屐屙孱蝈疱狒┅ㄩ泗灬礅溽īㄩ泗癌痱镧ㄤ邈泗颟鲠祯弩屐屙孱舂鲠祯弩铋铋飑┅灬礅溽ī鲠祯弩屐屙孱舂┅┅ㄤ彐躅箦ㄣ镬戾泗轱瞟ㄥ豉疱汜箦泔祆邈糸镱篝蜷铉麒孱戾铉翳泔祆邈糸镱癌磲脲篝蜷铉沆戥箦后趄轭泔祆邈糸镱┅扉篝麒孱泔祆邈糸镱磲脲扉篝沆戥箦红轶泔祆邈糸镱┅鲥泗矧麒孱戾铉翳泔祆邈糸镱癌磲脲鲥泗矧沆戥箦忽邈麸泔祆邈糸镱┅ㄣ礻箦泔祆邈糸镱铛祆铋飑┅ㄤ彐躅鲠祗磲皓ㄥ豉疱汜箦磲ㄨ狍璀翎忪麒孱ㄨ狍璀翎忪瀛泔躅磲皓癌箦ㄡ戾犷潋獒鸿狍璀翎忪瀛鲠祯弩磲皓┅换物灬脔腚铛祆铋飑┅ㄤ彐躅脲磲皓ㄥ豉疱汜箦磲ㄨ狍璀翎忪麒孱ㄨ狍璀翎忪瀛泔躅磲皓癌箦ㄡ戾犷潋獒鸿狍璀翎忪瀛脲磲皓┅铛祆铋飑┅换藻篝ㄤ彐躅箦窨ㄣ礻箦癍┅换婶弪狒矧ㄤ彐磲泸滹箦箦癍屮痱怙澌怙澌换韵南蔑眇戾溴篝蝓泗躜轭戾舄è祗ㄣ潋箦癍屮痱螬鲠蝮祜镳骘鲠箦瘵镱祗怡＇沅潋泔祆邈扉篝鲠箦ㄧ孱簌愆ㄧ孱簌愆┅┅啜祜镳括祜镳骘鲠轸箦蝈磲轭轭绌轭鲠蝮狃疱钿啜鏖翳箦磲脲轸弪狒矧轸颟┅括祜镳骘鲠轸箦蝈磲轭轭绌轭鲠蝮狃疱钿啜骘ì蝈磲轭轭鲠颟眭祠轲戾鲠祯瀛扉篝ㄦ躅汜祆箦瘵┅麒殪ㄡ钿括祜镳骘鲠轸簌蝈磲轭轭绌轭鲠蝮泔祆邈蝈磲轭轭绌滹棱镤┅ㄤ彐磲泸沆戥滹糸礤ㄢ轭溟铉怙澌怙澌戾è祗ㄣ潋忾钿轭珞┅麒孱ǒ戾铉翳祗舂博ㄥ蝌矧⒙轭溟铉箬秕熹忮轭翳骘蝽埒兼轼铛砭茛┅啜滹糸礤祗棱镤┅ㄤ彐磲泸麒殪翦篝怙澌怙澌啜祜镳麒殪翦篝滹痱镧棱镤┅ㄤ彐磲泸骘īㄥ蝌矧⒃夏虾物轫痨屙孱翦洧┅ㄤ彐躅沆戥磲ㄦ蝈篝泔祗磲脲沆矬躜瀛沆戥箦虹孱弪狒瀛轸弪狒矧灬礅溽ī戾è轸蝮磲疸狎＇磲脲轸弪狒矧泔祗┅灬礅溽ī祜镳骘轸轭轸蝮骘蝈磲轭轭鲠飑眭祠轲戾鲠祯瀛扉篝ㄦ躅汜祆轸颟躅戾篌蝈磲轭轭滹蝈趱蝾鲠祯弩蝈磲轭轭铋飑孱泔祆邈鲠轭麸鲠祗骈钺祆蝈趱蝾鲠祯弩ㄡ痧禊鲠祗┅┅┅┅ㄤ彐躅蜥铉é镳糸镱犰狎绫狎绮狎绯换韵南洛趑弪弪蝻汨邈腴铉ㄣ镱è犷狎绫狎绮狎绯磲脲蜥铉瀛沆戥箦后翎螋狎绫哄钿狎绮后翦狎绯┅è犷狎绫狎绮磲脲蜥铉瀛沆戥箦后翎螋狎绫哄钿狎绮后翦暴ㄡ蜱磲脲蜥铉瀛沆戥箦后翎螋哄钿狎绫后翦暴磲脲蜥铉瀛沆戥箦后翎螋哄钿铋后翦暴┅ㄤ彐躅蝈疱狒ㄡ蜱镳糸镱犰ㄡ蜱с礻蝈疱狒秭弪祜徜栳汶┅ㄩㄥс礻蝈疱狒秭弪祜徜栳汶狎绮磲脲蝈疱狒沆戥箦哄戾礤铘狎绫磲脲蝈疱狒沆戥箦哄戾礤铘狎绮恒秕铘狎绫┅换涕篝屮翦钿弪ㄤ彐躅沆戥泔躅螬ㄥ豉疱汜箦铛祆癌扉篝戾铉翳螬鲥泗矧戾铉翳螬ㄣ礻箦祜镳鏖翳轸磲脲轸弪狒矧螬麒殪ㄦ躅汜祆轸颟泔躅暴┅ㄤ彐躅鲥é蝈篝狎珞戾è戾戾铉翳狎珞┅磲脲狎蜥戾洪铋糸犰泔铘孱趔狎珞┅ㄤ彐躅泔钽狒é蝈篝箦耋戾è戾戾铉翳箦耋┅换韵南铒熄瞟ㄣ镱è戾瞟铋飑è戾瞟ㄣ狎箦耋┅磲脲眭祠榄沆戥箦后羼蹂钽弩ㄡ痧禊＇鲥泗矧箦耋┅┅┅ㄤ彐躅泔铌ㄣ镬蝈篝蝈篝换韵南磲篚痧矧舢戾è箦泔毂┅ㄩㄣ镱汜箦蝈篝┅箦蝈篝┅┅ㄤ彐躅沆戥泔铙箦聃孱沐ㄣ镱汜箦扉篝┅箦箦聃孱沐┅ㄤ彐磲泸灬汜é蝈篝泔祗换韵南碰犰踽翦镱禊镱沐啜磲脲灬汜舡箦哄痱弩箝镱К泔祗┅ㄤ彐躅磲疸狒ㄦ蝈篝泔祗戾èㄡ痧禊＇沆戥磲ㄣ镱泔祗┅┅ㄡ痧禊＇泔钽狒ㄣ礻扉篝颟┅换序邃殂狒弩ㄤ彐躅屙痿ㄣ镬换韵南审翳轶蝈犰禊屙痿铒泔飑换则犷箧矧箦聃孱沐ㄤ彐躅沆戥扉篝ㄣ镬飑戾颟ㄤ锃箦埒泔祆瘐箬颟铗弼弪箦颟┅ㄤ彐躅沆戥蝈鲥蝮ㄣ镬飑换物灬狍疱箴邈殒殂狒轱换韵南骑箦趔麒弪麇腩秣翳戾铉翳翳轶泔蹯躞鲥泗矧戾è铋飑ㄤ锃箦埒泔祆瘐箬颟颟ㄤ彐躅沆戥箫螋ㄡ蜱镳糸镱犰狎绮灬忮祗è箫螋ㄣ镯疳蝈泔祆戾èㄣ礻扉篝泔祆┅箫螋泔眇狎弪┅┅ㄣ镱è犷箦狎绫铛祆狎绮┅箫螋＇狎绫┅è骢钽糸镱狎绫箫螋狎绫狎绮┅换韵南洛趑弪弪蝻蝮ㄥ蝌矧⒙徜狎珲礤铘骘沆戥箫螋┅┅换义盹鲥轸屙骝镯箦聃孱沐ㄤ彐躅骈祠弪ㄧ孱痱邃殂狒泔祆磲脲沆矬躜瀛沆戥箦虹孱弪狒瀛轸弪狒矧灬礅溽ī戾è轸磲脲轸弪狒矧泔祆┅痱邃ㄦ躅汜祆珏瞽痱邃殂狒濠┅灬礅溽ī祜镳钺礤骘蝈磲轭轭鲠飑眭祠轲戾鲠祯瀛扉篝ㄦ躅汜祆轸颟滹ㄩ蝈磲轭轭麒孱ㄦ躅汜祆痱邃鲠飑蝈趱蝾骝镯鲠祯弩鲠飑┅蝈趱蝾骝镯鲠祯弩铋铋飑┅┅┅┅ㄤ彐躅骈祠弪痱邃泔祆ㄦ殪翦颔灬礅溽ī痱邃泔祆┅ㄤ彐躅沆戥蝈盹鲥痱邃泔祆ㄦ殪翦颔灬礅溽ī灬礅溽铒ㄦ躅汜祆痱邃┅┅泔祆┅ㄤ彐躅溟篝轭泗ㄣ镬飑ㄦ殪翦颔灬礅溽ī戾è箦磲脲栳箬翎忪呼弩у聃犰┅灬礅溽躅戾篌ㄧ弭栳箬箦舂箦翩ㄧ弭栳箬箦舂舂舂┅泔祆┅ㄤ彐躅骒狒翦灬忮祗è骒狒翦睽蝻雉轸颟戾ㄣ躜蝈铘轸颟灬礅溽ī祜镳钺礤秕翦麒殪滹ㄩ沲蝌孱舡轸眭祠轲戾鲠祯瀛忾钿蝈鲠飑ㄦ躅汜祆沲蝌孱舡轸颟ㄩ蝈蝈趱蝾骝镯秕翦鲠祯弩蝈鲠飑箦翩沲蝌孱舡轸铋飑┅眭祠轲戾鲠祯瀛忾钿蝈鲠飑ㄦ躅汜祆蝻雉轸颟ㄩ铛祆蝈愆蝈趱蝾骝镯秕翦鲠祯弩蝈鲠飑戾è铄鳝轸磲脲轸弪狒矧鲠飑┅ㄩ铄鳝轸箦翩沲蝌孱舡轸ㄦ灬趑孱铄鳝轸颟蝈趱蝾骝镯秕翦鲠祯弩蝈鲠飑┅┅┅┅┅磲脲沆矬躜瀛沆戥箦虹孱弪狒瀛轸弪狒矧灬礅溽īㄦ灬趑孱磲脲轸弪狒矧┅┅┅ㄤ彐躅溴漉疱ㄣ镬飑ㄦ殪翦颔灬礅溽ī戾è灬篝ㄧ孱簌愆┅灬礅溽躅戾篌ㄥ聃犰灬篝箦翩灬篝舂┅泔祆┅ㄤ彐躅蜥钿镯筢眇戾痱镡泔祆ㄡ篌弪窘痱镡癌ㄡ篌弪冀痱镡暴ㄦ殪翦颔灬礅溽ī灬礅溽ㄤ邈灬蝈ㄩ珙矧┅蜥钿镯碑癌痱镡┅泔祆┅ㄤ彐躅蝈疱狒骈蝮籁ㄣ镬飑磲脲沆矬躜瀛沆戥箦虹孱弪狒瀛轸弪狒矧灬礅溽ī戾舄ㄩ铋糸犰辁邃蝈磲轭轭鲠飑灬礅溽ī躅戾篌轭轸獒扉邃眭祠轲戾鲠祯瀛忾钿雯ㄦ躅汜祆磲脲轸弪狒矧泔祆┅箦翩蝈磲轭轭鲠雯┅鲠祯弩蝈磲轭轭鲠飑┅┅ㄤ彐躅翎脲铘泔祆ㄩ癌ㄦ殪翦颔灬礅溽ī戾è泐癌灬礅溽ㄤ邈灬蝈ㄩ珙矧┅ㄩ泐癌痱镧箦翩泐瞟舂痱镧ㄤ邈泐舂┅┅泔祆蝈疱狒骈蝮籁泔祆┅ㄤ彐躅翎脲泔祆磲脲沆矬躜瀛沆戥箦虹孱弪狒瀛轸弪狒矧灬礅溽ī戾è泐癌ㄩ趄磲脲轸弪狒矧泔祆┅灬礅溽īㄩ泐瞟痱镧ㄩ钽泐舂ㄦ躅汜祆轸颟鲠祯弩铋铋飑┅┅┅ㄤ彐躅沆戥篚怏羼筱篝狎舡翦篝篝狎舡脲镳糸镱犰孱洵翦篝孱洵脲换韵南深趄镤蹉泔钽屦镦箫螋邃箦换韵南藻篝翳狒筱轶箫螋邃泔祆邈糸镱换韵南歪脲孱洵翦篝孱洵脲盹蝈沆镪躜泔眇扉犷磲脲沆矬躜瀛沆戥箦虹孱弪狒瀛轸弪狒矧灬礅溽ī戾è轸磲脲轸弪狒矧筱┅骘躅洵篝狎骘躅洵孱洎灬忮祗è蝈趱蝾躅戾篌孱蝈磲轭轭轸屙ㄩㄡ钿蝈磲轭轭矧铒孱洵翦篝ㄦ躅汜祆孱洵翦篝轸屙孱洵脲┅鲠祯弩蝈磲轭轭轸屙痱镧箦翩骘躅洵孱舂鲠祯弩铋铋飑┅┅灬礅溽īㄣ镱ㄦ秕钿孱鲠祯弩铋铋飑è铛祆骘躅洵篝狎舂祜镳骘蝈磲轭轭轸屙眭祠轲戾鲠祯瀛扉篝ㄦ躅汜祆轸颟麒孱矧铒蝈磲轭轭绌ㄦ躅汜祆篝狎舡翦篝轸屙篝狎舡脲┅滹蝈趱蝾痱镧箦翩骘躅洵篝狎舂蝈趱蝾躅戾篌孱蝈磲轭轭轸屙┅┅眭祠轲戾鲠祯瀛忾钿蝈磲轭轭轸屙ㄦ躅汜祆轸颟蝈趱蝾躅戾篌孱蝈磲轭轭轸屙┅┅┅┅┅ㄤ彐躅沆戥蝮踱箦筱篝狎舡翦篝篝狎舡脲镳糸镱犰孱洵翦篝孱洵脲ㄣ礻篚怏羼ㄣ礻蝈鲥蝮筱篝狎舡翦篝篝狎舡脲孱洵翦篝孱洵脲┅换序弭豉痱轭ㄤ彐礤翳镤痱轭舡镡赍泗è箦沆戥箦瘵篝蝈犴黩轸瀛汨狎＼篝蝈犴戾ㄡ骠弪骈蝮舂ㄤ锃箦埒箦褫麒孱徭翦颦骈蝮黩轸瀛汨狎＼篝蝈犴┅豉疱汜箦ㄣ栳蜥泗弪黩轸瀛汨狎＼篝蝈犴黩轸瀛汨狎篝蝈犴┅痱轭篝蝈犴┅箦翩徭翦颦骈蝮舂┅黩轸瀛汨狎＼篝蝈犴┅